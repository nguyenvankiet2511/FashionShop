<!DOCTYPE html>
<html lang="en">
<head>
    <title>Cosmic Store</title>
    <link rel="icon" type="image/png" href="static/images/icons/favicon.png"/>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Colo Shop Template">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/bootstrap4/bootstrap.min.css') }}">
    <link rel="stylesheet" type="text/css"
          href="{{ url_for('static', filename='plugins/font-awesome-4.7.0/css/font-awesome.min.css') }}">
    <link rel="stylesheet" type="text/css"
          href="{{ url_for('static', filename='plugins/OwlCarousel2-2.2.1/owl.carousel.css') }}">
    <link rel="stylesheet" type="text/css"
          href="{{ url_for('static', filename='plugins/OwlCarousel2-2.2.1/owl.theme.default.css') }}">
    <link rel="stylesheet" type="text/css"
          href="{{ url_for('static', filename='plugins/OwlCarousel2-2.2.1/animate.css') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/carts.css') }}">
</head>

<body>

<div class="super_container">

    <!-- Header -->

    <header class="header trans_300">

        <!-- Top Navigation -->

        <div class="top_nav">
            <div class="container">
                <div class="row">
                    <div class="col-md-6">
                        <div class="top_nav_left"></div>
                    </div>
                    <div class="col-md-6 text-right">
                        <div class="top_nav_right">
                            <ul class="top_nav_menu">

                                <!-- Currency / Language / My Account -->

                                <li class="currency">
                                    <a href="#">
                                        usd
                                        <i class="fa fa-angle-down"></i>
                                    </a>
                                    <ul class="currency_selection">
                                        <li><a href="#">cad</a></li>
                                        <li><a href="#">aud</a></li>
                                        <li><a href="#">eur</a></li>
                                        <li><a href="#">gbp</a></li>
                                    </ul>
                                </li>
                                <li class="language">
                                    <a href="#">
                                        English
                                        <i class="fa fa-angle-down"></i>
                                    </a>
                                    <ul class="language_selection">
                                        <li><a href="#">French</a></li>
                                        <li><a href="#">Italian</a></li>
                                        <li><a href="#">German</a></li>
                                        <li><a href="#">Spanish</a></li>
                                    </ul>
                                </li>
                                <li class="account">
                                    <a href="#">
                                        My Account
                                        <i class="fa fa-angle-down"></i>
                                    </a>
                                    {% if user is none %}
                                    <ul class="account_selection">
                                        <li><a href="{{url_for('show_login')}}"><i class="fa fa-sign-in"
                                                                                   aria-hidden="true"></i>Sign In</a>
                                        </li>
                                        <li><a href="{{url_for('show_login')}}"><i class="fa fa-user-plus"
                                                                                   aria-hidden="true"></i>Register</a>
                                        </li>
                                    </ul>
                                    {% else %}
                                    <ul class="account_selection">

                                        <li><a href="{{url_for('view_profile')}}"><i class="fa fa-sign-in"


                                                                                     aria-hidden="true"></i>Profile</a>
                                        </li>
                                        <li><a href="{{url_for('user_logout')}}"><i class="fa fa-user-plus"
                                                                                    aria-hidden="true"></i>Logout</a>
                                        </li>
                                    </ul>
                                    {% endif %}
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Navigation -->

        <div class="main_nav_container">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12 text-right">
                        <div class="logo_container">
                            <a href="{{url_for('home')}}">colo<span>shop</span></a>
                        </div>
                        <nav class="navbar">
                            <ul class="navbar_menu">
                                <li><a href="{{url_for('home')}}">home</a></li>
                                <li><a href="{{url_for('view_categories')}}">shop</a></li>
                                <li><a href="#">promotion</a></li>
                                <li><a href="#">pages</a></li>

                                <li><a href="{{url_for('view_blog')}}">blog</a></li>
                                <li><a href="{{url_for('view_contact')}}">contact</a></li>


                            </ul>
                            <ul class="navbar_user">
                                <li class="search-container">
                                    <a href="#" id="search-icon">
                                        <i class="fa fa-search" aria-hidden="true"></i>
                                    </a>
                                    <div class="search-box" id="search-box">
                                        <input type="text" placeholder="Search...">
                                        <button type="button" id="search-btn">Search</button>
                                    </div>
                                </li>
                                {% if user %}
                                <li class="user-menu">

                                    <a href="{{url_for('view_profile')}}">


                                        <i class="fa fa-user" aria-hidden="true"></i>
                                        <span class="user-text">{{user.name}}</span>
                                    </a>
                                </li>
                                {% else %}
                                <li class="user-menu">
                                    <a href="{{url_for('show_login')}}">
                                        <i class="fa fa-user" aria-hidden="true"></i>
                                        <span class="user-text">Đăng nhập</span>
                                    </a>
                                </li>
                                {% endif %}

                                <li class="checkout">
                                    <a href="cart.html">
                                        <i class="fa fa-shopping-cart" aria-hidden="true"></i>
                                        {% if countCart %}
                                        <span id="checkout_items" class="checkout_items">{{countCart}}</span>
                                        {% endif %}
                                    </a>
                                </li>
                            </ul>
                            <div class="hamburger_container">
                                <i class="fa fa-bars" aria-hidden="true"></i>
                            </div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>

    </header>

    <div class="fs_menu_overlay"></div>
    <div class="hamburger_menu">
        <div class="hamburger_close"><i class="fa fa-times" aria-hidden="true"></i></div>
        <div class="hamburger_menu_content text-right">
            <ul class="menu_top_nav">
                <li class="menu_item has-children">
                    <a href="#">
                        usd
                        <i class="fa fa-angle-down"></i>
                    </a>
                    <ul class="menu_selection">
                        <li><a href="#">cad</a></li>
                        <li><a href="#">aud</a></li>
                        <li><a href="#">eur</a></li>
                        <li><a href="#">gbp</a></li>
                    </ul>
                </li>
                <li class="menu_item has-children">
                    <a href="#">
                        English
                        <i class="fa fa-angle-down"></i>
                    </a>
                    <ul class="menu_selection">
                        <li><a href="#">French</a></li>
                        <li><a href="#">Italian</a></li>
                        <li><a href="#">German</a></li>
                        <li><a href="#">Spanish</a></li>
                    </ul>
                </li>
                <li class="menu_item has-children">
                    <a href="#">
                        My Account
                        <i class="fa fa-angle-down"></i>
                    </a>
                    {% if user is none %}
                    <ul class="account_selection">
                        <li><a href="{{url_for('show_login')}}"><i class="fa fa-sign-in" aria-hidden="true"></i>Sign In</a>
                        </li>
                        <li><a href="{{url_for('show_login')}}"><i class="fa fa-user-plus" aria-hidden="true"></i>Register</a>
                        </li>
                    </ul>
                    {% else %}
                    <ul class="account_selection">

                        <li><a href="{{url_for('view_profile')}}"><i class="fa fa-sign-in" aria-hidden="true"></i>Profile</a>


                        </li>
                        <li><a href="{{url_for('user_logout')}}"><i class="fa fa-user-plus" aria-hidden="true"></i>Logout</a>
                        </li>
                    </ul>
                    {% endif %}
                </li>
                <li class="menu_item"><a href="{{url_for('home')}}">home</a></li>
                <li class="menu_item"><a href="{{url_for('view_categories')}}">shop</a></li>
                <li class="menu_item"><a href="#">promotion</a></li>
                <li class="menu_item"><a href="#">pages</a></li>

                <li class="menu_item"><a href="{{url_for('view_blog')}}">blog</a></li>
                <li class="menu_item"><a href="{{url_for('view_contact')}}">contact</a></li>


            </ul>
        </div>
    </div>


    <div class="shopping-cart">
        <h2>Shopping Cart</h2>
        <div class="shopping-cart-1">
            <div class="column-labels">
                <label class="product-image">Image</label>
                <label class="product-details">Product</label>
                <label class="product-price">Price</label>
                <label class="product-quantity">Quantity</label>
                <label class="product-removal">Remove</label>
                <label class="product-line-price">Total</label>
            </div>
            <form id="checkoutForm" action="{{url_for('checkout')}}" method="post">
                {% for product in listProducts %}
                <div class="product">
                    <div class="product-image">
                        <img src="{{url_for('static', filename='images/'+product.product_images)}}">
                    </div>
                    <div class="product-details">
                        <div class="product-title">{{product.product_name}}</div>
                        <p class="product-description">{{product.product_description}}</p>
                    </div>
                    <div class="product-price">
                        {{product.product_price-product.product_price*product.product_discount/100}}
                    </div>
                    <div class="product-quantity">
                        <input type="number" value="{{ product.quantity }}" min="1"
                               data-cart-id="{{ product.cart_id }}"
                               onchange="updateCartQuantity(this)">
                    </div>
                    <div class="product-removal">
                        <button onclick="removeToCart({{product.cart_id}},this)" class="remove-product">
                            Remove
                        </button>
                    </div>
                    <div class="product-line-price">
                        {{(product.product_price-product.product_price*product.product_discount/100)*product.quantity}}
                    </div>
                    <input hidden value="{{product.cart_id}}" name="cart_id">
                </div>
                {% endfor %}

                <input name="subtotal" id="hidden-subtotal" type="hidden" value="">
                <input name="tax" id="hidden-tax" type="hidden" value="">
                <input name="total" id="hidden-total" type="hidden" value="">
                <div class="totals">
                    <div class="totals-item">
                        <label>Subtotal :</label>
                        <div class="totals-value" id="cart-subtotal">0.0</div>
                    </div>
                    <div class="totals-item">
                        <label>Tax (5%) :</label>
                        <div class="totals-value" id="cart-tax">0.0</div>
                    </div>

                    <div class="totals-item totals-item-total">
                        <label>Grand Total :</label>
                        <div class="totals-value" id="cart-total"></div>
                    </div>
                </div>
                {% if countCart %}
                <button type="submit" class="checkout-1">
                    <h5>Checkout</h5>
                </button>
                {% else %}
                <a class="checkout-1" onclick="checkOutError()" style="text-align: center;">
                    <h5>Checkout</h5>
                </a>
                {% endif %}
            </form>
        </div>
    </div>


    <!-- Newsletter -->

    <div class="newsletter">
        <div class="container">
            <div class="row">
                <div class="col-lg-6">
                    <div class="newsletter_text d-flex flex-column justify-content-center align-items-lg-start align-items-md-center text-center">
                        <h4>Newsletter</h4>
                        <p>Subscribe to our newsletter and get 20% off your first purchase</p>
                    </div>
                </div>
                <div class="col-lg-6">
                    <form action="post">
                        <div class="newsletter_form d-flex flex-md-row flex-column flex-xs-column align-items-center justify-content-lg-end justify-content-center">
                            <input id="newsletter_email" type="email" placeholder="Your email" required="required"
                                   data-error="Valid email is required.">
                            <button id="newsletter_submit" type="submit" class="newsletter_submit_btn trans_300"
                                    value="Submit">subscribe
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <div class="footer__about">

                        <p>We prioritize creating a personalized shopping experience for every customer, ensuring that
                            every visit feels unique and special.</p>
                        <i>Address :<a href="index.html">shoppingnow@gmail.com</a></i>

                        <a href="#"><img src="{{ url_for('static', filename='images/icons/payment.png') }}"
                                         alt="Payment Methods"></a>
                    </div>
                </div>
                <div class="col-lg-2 offset-lg-1 col-md-3 col-sm-6">
                    <div class="footer__widget">
                        <h6>Shopping</h6>
                        <ul>
                            <li><a href="#">Clothing Store</a></li>
                            <li><a href="#">Trending Shoes</a></li>
                            <li><a href="#">Accessories</a></li>
                            <li><a href="#">Sale</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-2 col-md-3 col-sm-6">
                    <div class="footer__widget">
                        <h6>Customer Service</h6>
                        <ul>
                            <li><a href="#">Contact Us</a></li>
                            <li><a href="#">Payment Methods</a></li>
                            <li><a href="#">Delivery</a></li>
                            <li><a href="#">Return & Exchanges</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-3 offset-lg-1 col-md-6 col-sm-6">
                    <div class="footer__widget">
                        <h6>Newsletter</h6>
                        <div class="footer__newslatter">
                            <p>Be the first to know about new arrivals, look books, sales & promos!</p>

                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-12 text-center">
                    <div class="footer__copyright__text">
                        <p>Welcome to our shopping page
                            <script>
                                document.write(new Date().getFullYear());
                            </script>
                            <i class="fa fa-heart-o" aria-hidden="true"></i> by <a href="index.html" target="_blank">Cosmic
                                Store</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- Footer Section End -->


</div>

<script src="{{ url_for('static', filename='js/jquery-3.2.1.min.js') }}"></script>
<script src="{{ url_for('static', filename='css/bootstrap4/popper.js') }}"></script>
<script src="{{ url_for('static', filename='css/bootstrap4/bootstrap.min.js') }}"></script>
<script src="{{ url_for('static', filename='plugins/Isotope/isotope.pkgd.min.js') }}"></script>
<script src="{{ url_for('static', filename='plugins/OwlCarousel2-2.2.1/owl.carousel.js') }}"></script>
<script src="{{ url_for('static', filename='plugins/easing/easing.js') }}"></script>
<script src="{{ url_for('static', filename='js/carts.js') }}"></script>
<script>
    function updateHiddenFields() {
        const subtotal = document.getElementById('cart-subtotal').innerText;
        const tax = document.getElementById('cart-tax').innerText;
        const total = document.getElementById('cart-total').innerText;

        document.getElementById('hidden-subtotal').value = subtotal;
        document.getElementById('hidden-tax').value = tax;
        document.getElementById('hidden-total').value = total;

         console.log('Updated Values:');
        console.log('Subtotal:', subtotal);
        console.log('Tax:', tax);
        console.log('Total:', total);
    }

    // Create an observer instance linked to the callback function
    const observer = new MutationObserver(() => {
        updateHiddenFields();
    });

    // Options for the observer (which mutations to observe)
    const config = { childList: true, subtree: true, characterData: true };

    // Target nodes to observe
    const targets = document.querySelectorAll('.totals-value');

    // Start observing each target node
    targets.forEach(target => {
        observer.observe(target, config);
    });

    // Initial update
    updateHiddenFields();
</script>
<script src="https://www.gstatic.com/dialogflow-console/fast/messenger/bootstrap.js?v=1"></script>
<df-messenger
        intent="WELCOME"
        chat-title="CosmicStore"
        agent-id="882ca08b-e5e4-4a0b-92cb-711591fb8ccf"
        language-code="vi"
></df-messenger>
</body>

</html>
